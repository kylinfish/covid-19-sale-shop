<!doctype html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="covid-19 防疫期間，美食商家優惠清單列表">
    <meta name="author" content="kylinfish">
    <meta property="og:title" content="COVID19 台灣美食優惠商家">
    <meta property="og:description" content="covid-19 防疫期間，美食商家優惠清單列表">
    <meta property="og:url" content="https://covid19-sale.tw">
    <meta property="og:site_name" content="COVID19 台灣美食優惠商家">
    <meta property="og:image" content="/img/og_img.jpg">
    <meta property="article:publisher" content="https://www.facebook.com/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="COVID19 台灣美食優惠商家">
    <meta name="twitter:description" content="covid-19 防疫期間，美食商家優惠清單列表">
    <meta property="twitter:image:src" content="/img/og_img.jpg">
    <title>COVID19 台灣美食優惠商家</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background: #EEE;
        }
    </style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0HN2M5MW02"></script>
</head>

<body>
    <a class="h5 px-1"
        href="https://docs.google.com/forms/d/e/1FAIpQLSeUwvAlhrrYDblrKaibyby_urF_q6j5PCCMY0RfISSkvsslvA/viewform">👉
        店家申請表單</a>
    <a class="h5" href="https://xlashie.com">🐤 微型商家客戶管理</a>

    <div class="container p-2">
        <div class="p-3 mt-4 mb-4 bg-light rounded-3">
            <div class="container-fluid">
                <h1 class="display-5 fw-bold">COVID19 台灣美食優惠商家</h1>
                <img class="d-none" src="img/og_img.jpg" width="100%">
                <p class="col-md-8 fs-4">
                    防疫大家一起來，台灣加油
                    🍕🍝🥪🌮🌯🥙🧆🍜🥘🥃🥂🍸🍛🍱🍣
                </p>

                <form>
                    <div class="form-group">
                        <label for="exampleFormControlSelect1">店家性質</label>
                        <select class="form-control" id="selectedShopType">
                            <option selected value="">全部</option>
                            <option>單店</option>
                            <option>連鎖</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exampleFormControlSelect1">區域</label>
                        <select class="form-control" id="selectedZone">
                            <option value="">全部</option>
                            <option value="台北市">臺北市</option>
                            <option value="中正區"> - 中正區</option>
                            <option value="大同區"> - 大同區</option>
                            <option value="中山區"> - 中山區</option>
                            <option value="萬華區"> - 萬華區</option>
                            <option value="信義區"> - 信義區</option>
                            <option value="松山區"> - 松山區</option>
                            <option value="大安區"> - 大安區</option>
                            <option value="南港區"> - 南港區</option>
                            <option value="北投區"> - 北投區</option>
                            <option value="內湖區"> - 內湖區</option>
                            <option value="士林區"> - 士林區</option>
                            <option value="文山區"> - 文山區</option>
                            <option value="新北市">新北市</option>
                            <option value="板橋區"> - 板橋區</option>
                            <option value="新莊區"> - 新莊區</option>
                            <option value="泰山區"> - 泰山區</option>
                            <option value="林口區"> - 林口區</option>
                            <option value="淡水區"> - 淡水區</option>
                            <option value="金山區"> - 金山區</option>
                            <option value="八里區"> - 八里區</option>
                            <option value="萬里區"> - 萬里區</option>
                            <option value="石門區"> - 石門區</option>
                            <option value="三芝區"> - 三芝區</option>
                            <option value="瑞芳區"> - 瑞芳區</option>
                            <option value="汐止區"> - 汐止區</option>
                            <option value="平溪區"> - 平溪區</option>
                            <option value="貢寮區"> - 貢寮區</option>
                            <option value="雙溪區"> - 雙溪區</option>
                            <option value="深坑區"> - 深坑區</option>
                            <option value="石碇區"> - 石碇區</option>
                            <option value="新店區"> - 新店區</option>
                            <option value="坪林區"> - 坪林區</option>
                            <option value="烏來區"> - 烏來區</option>
                            <option value="中和區"> - 中和區</option>
                            <option value="永和區"> - 永和區</option>
                            <option value="土城區"> - 土城區</option>
                            <option value="三峽區"> - 三峽區</option>
                            <option value="樹林區"> - 樹林區</option>
                            <option value="鶯歌區"> - 鶯歌區</option>
                            <option value="三重區"> - 三重區</option>
                            <option value="蘆洲區"> - 蘆洲區</option>
                            <option value="五股區"> - 五股區</option>
                            <option value="基隆市">基隆市</option>
                            <option value="桃園市">桃園市</option>
                            <option value="新竹縣">新竹縣</option>
                            <option value="新竹市">新竹市</option>
                            <option value="苗栗縣">苗栗縣</option>
                            <option value="台中市">台中市</option>
                            <option value="南投縣">南投縣</option>
                            <option value="彰化縣">彰化縣</option>
                            <option value="雲林縣">雲林縣</option>
                            <option value="嘉義縣">嘉義縣</option>
                            <option value="嘉義市">嘉義市</option>
                            <option value="台南市">台南市</option>
                            <option value="高雄市">高雄市</option>
                            <option value="屏東縣">屏東縣</option>
                            <option value="宜蘭縣">宜蘭縣</option>
                            <option value="花蓮縣">花蓮縣</option>
                            <option value="台東縣">台東縣</option>
                            <option value="澎湖縣">澎湖縣</option>
                            <option value="金門縣">金門縣</option>
                            <option value="連江縣">連江縣</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="exampleFormControlSelect1">服務類型</label>
                        <select class="form-control" id="selectedFoodType">
                            <option value="" selected>全部</option>
                            <option value="餐廳">餐廳</option>
                            <option value="飲料">飲料</option>
                            <option value="點心">點心</option>
                            <option value="生鮮">生鮮</option>
                            <option value="其他">其他</option>
                        </select>
                    </div>
                </form>
            </div>
        </div>
        <div class="col mb-2 text-right">總共搜尋到: <b class="text-info" id="numberOfShop"></b> 間資料</div>
        <div id="shopList" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3"></div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        (function ($) {
            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());
            gtag('config', 'G-0HN2M5MW02');

            let items = [];
            const dataSheetURL =
                "https://spreadsheets.google.com/feeds/list/1vCs5Duf5COFuTgEQR5M7qAvWGRhEU8KN8l--zaEdd60/1/public/values?alt=json"

            $.get(dataSheetURL, function (data) {
                let d = data.feed.entry;

                for (let i in d) {
                    let item = {};
                    item.name = d[i].gsx$name.$t;
                    item.address = d[i].gsx$address.$t;
                    item.phone = d[i].gsx$phone.$t;
                    item.description = d[i].gsx$description.$t;
                    item.food_type = d[i].gsx$foodtype.$t;
                    item.shop_type = d[i].gsx$shoptype.$t;
                    item.ended_at = d[i].gsx$endedat.$t;
                    items.push(item);
                }

                items.sort(() => Math.random() - 0.5)
                updateItems(items);
            });

            function updateItems(items) {
                let filterZone = $('#selectedZone').val()
                let filterFoodType = $('#selectedFoodType').val()
                let filterShopType = $('#selectedShopType').val()

                items = items.filter(item =>
                    (filterZone == '' || item.address.indexOf(filterZone) !== -1) &&
                    (filterFoodType == '' || item.food_type.indexOf(filterFoodType) !== -1) &&
                    (filterShopType == '' || item.shop_type.indexOf(filterShopType) !== -1)
                )

                $('#numberOfShop').text(items.length)
                $('#shopList').html('');

                items.forEach(function (item) {
                    const Card = `
                        <div class="col">
                            <div class="card shadow-sm mb-2">
                                <div class="card-body">
                                    <badge class="float-right badge badge-info">${item.food_type}</badge>
                                    <h2>${item.name}</h2>

                                    <pre class="h5 text-danger">${item.description}</pre>
                                    <p><b>優惠截止日: </b>${item.ended_at}</p>
                                    <p class="description"><b>地址</b>: ${item.address}</p>

                                    <div class="d-flex justify-content-between align-items-center">
                                        <a href="tel:${item.phone}" class="btn btn-sm btn-primary btn-block">打電話預訂</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    $('#shopList').append(Card);
                })
            }

            $("select").change(function () {
                updateItems(items)
            });
        })(jQuery);
    </script>
</body>
</html>